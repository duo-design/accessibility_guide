<html>
  <head>
    <style type="text/css">
      :root {
        color: #000;
        font-family: "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        font-size: 18px;
        line-height: 1.5;
      }

      main {
        padding-top: 1.5rem 1rem 2rem;
      }

      h2, h3, h4 {
        margin-top: 1.5em;
        margin-bottom: 0;
      }

      h2 {
        border-top: 2px solid black;
        margin-top: 1em;
        padding-top: 0.5em;
      }

      aside h2:first-child,
      aside h3:first-child,
      aside h4:first-child {
        margin-top: 0;
      }

      h1 { font-size: 2.5rem }
      h2 { font-size: 2rem }
      h3 { font-size: 1.5rem }
      h4 { font-size: 1rem }

      p, ul, ol {
        max-width: 35rem;
      }

      main {
        --content-size: 35rem;
        --note-size: 25rem;
        --gap: 2rem;
        width: calc(var(--content-size) + var(--note-size) + var(--gap));
        margin: 0 auto;
        display: grid;
        grid-template-columns: var(--content-size) var(--note-size);
        grid-gap: 0 var(--gap);
      }

      main > .document-header,
      main > h2 {
        grid-column: 1 / -1;
        width: 100%;
      }

      main > * {
        grid-column: 1;
        margin-left: 0;
      }

      main > aside {
        grid-column: 2;
        margin-left: 0;
      }

      table {
        border-spacing: 0;
        border-collapse: collapse;
        margin-top: 2rem;
        margin-bottom: 2rem;
      }

      td,
      th {
        padding: 0.5rem;
        font-size: 14px;
        text-align: left;
        border: 1px solid #999;
        background-color: #fff;
      }

      td {
        font-family: monospace;
        font-size: 21px;
        font-weight: bold;
      }

      td .note {
        font-family: "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        font-size: 14px;
        display: block;
        font-weight: normal;
        margin: 0.5em 0 0 0;
      }

      th:first-child {
        text-align: right;
      }

      li {
        margin-top: 1rem;
      }
    </style>
  </head>

  <body>
    <main>
      <h1 class="document-header">
        Duo Color Palette Accessibility Requirements
      </h1>

      <h2>
        Introduction
      </h2>

      <div>
        <h3>
          What this document is
        </h3>

        <ul>
          <li>
            This document aims to be a complete list of the requirements Duo will use to check if a color palette meets Duo's accessibility needs.
          </li>

          <li>
            This document is a combination of current laws, standards, new guidelines that might be incorporated into future standards, industry best practices, and scientific research into how to create highly legible UI's for people with a wide range of disabilities.
          </li>

          <li>
            Unless otherwise mentioned, the items listed in this document are requirements, not nice to haves.
          </li>
        </ul>

        <h3>
          What this document is not
        </h3>

        <ul>
          <li>
            This is not comprehensive list of all accessibility guidelines and laws related to color. We have summarized and condensed many rules and guidelines to the essentials. If these core requirements can be met, the rest should be able to be met as well.
          </li>
          <li>
            This is not guide for how to design accessible components using colors.
          </li>
        </ul>
      </div>

      <aside>
        <h3>
          Motivation
        </h3>

        <p>
          We want a color palette that go beyond the basic legal requirements. We want palette that allows designers to create a great user experience for all sighted people, regardless of their visual acuity or color vision.
        </p>

        <p>
          In the past we have tried iterate on color palettes with quick informal accessibility reviews using the common best practices. Over time, some nasty edge cases were found that were hard to address with incremental improvements, and we learned that some common best practices were based on dated recommendations, or gave some people a degraded experience. To address this, we looked into what research has been done on human vision, readability, and color accessibility, then turned our learnings into this set of requirements.
        </p>
      </aside>

      <h2>
        Contrast
      </h2>

      <div>
        <p>
          These requirements are to ensure that text is readable and graphics are visible for people with a wide range of visual acuity and color perception. These measurements can not be used to tell how different objects look from one another based on color. <br> <a href="#distinct-colors">See note on measuring color differences.</a>
        </p>

        <p>
          All contrast requirements must be met against all background a color content will appear against in all themes. This is because some people with low vision need to use light mode as brighter backgrounds make it easier for them to read text. Others may need to use dark mode because they are sensitive to bright lights. Special accessibility themes are not viable because they create more work for designers and engineers, and some users don't have a choice about what theme an application uses because they are on a public device, or they have to pick one global setting for another piece of software to work for them.
        </p>
      </div>

      <aside>
        <h4 id="distinct-colors">
          Can't we use contrast measurements to measure color differences?
        </h4>

        <p>
          In many cases two colors need to look different. For example, links need to look different from plain text. Unfortunately, WCAG 2 contrast doesn't match human perception, and APCA measures how much contrast an object has against it's background. There is no good empirical measurement for how different one color looks from another.
        </p>

        <p>
          A good measurement would be very hard to create because perceived color is context dependent. Two colors that look similar next to each other can look different when placed in different parts of a page, and visa versa. Even worse, two objects with the same actual color can have different perceived colors depending on context, and visa versa.
        </p>


        <h4 id="wcag-3">
          What about WCAG 3?
        </h4>

        <p>
          Some blog posts, tweets and tools incorrectly mention "WCAG 3 requirements". WCAG 3 is still being written, it isn't an adopted standard. As of the writing of this document, the published draft of WCAG 3 doesn't contain any requirements, only initial thoughts on how WCAG 3 will be structured. APCA has been proposed as a measurement that could be used by WCAG 3, but APCA is still in beta and we don't know if it will be adopted by WCAG3 and how the measurements might be used by the standard.
        </p>
      </aside>

      <h3>
        WCAG 2 AA contrast
      </h3>

      <div>
        <p>
          These requirements help us meet legal our customer's legal needs. Due to differences in the way contrast is calculated, we must meet these as well as APCA requirements. APCA alone doesn't ensure legal compliance.
        </p>

        <p>
          Disabled text has no contrast requirements under WCAG 2, nor do logos.
        </p>

        <table>
          <tr>
            <th></th>
            <th>
              Regular
              <br>
              (less than 700)
            </th>
            <th>
              Bold
              <br>
              (at least 700)
            </th>
          </tr>
          <tr>
            <th>
              Normal text
            </th>
            <td colspan="2">4.5:1</td>
          </tr>
          <tr>
            <th>
              Large text
            </th>
            <td>
              3:1
              <span class="note">
                <strong>24px</strong> or larger for regular weight text.
              </span>
            </td>
            <td>
              3:1
              <span class="note">
                <strong>19px</strong> or larger for bold text.
              </span>
            </td>
          </tr>
          <tr>
            <th>
              Non-text components
              <br>
              (icons, buttons edges, input borders, etc)
            </th>
            <td colspan="2">3:1</td>
          </tr>
          <tr>
            <th>
              Disabled elements
            </th>
            <td colspan="2">
              <span class="note">
                No WCAG requirement
              </span>
            </td>
          </tr>
        </table>
      </div>

      <aside>
        <h4>
          What about WCAG 2 AAA contrast?
        </h4>
        <p>
          Previously we used WCAG 2 AAA when high legibility was important. However, the WCAG 2 contrast algorithm is flawed. Even at AAA levels, some hard to read colors pass. APCA provides a better way to set higher legibility requirements and helps us filter out hard to read color pairs that pass WCAG 2 AA.
        </p>

        <h4>
          What about Bridge-PCA?
        </h4>

        <p>
          Bridge-PCA is an attempt to merge WCAG 2 and APCA into one measurement. We don't use it because we want to be able to be able to make trade-off decisions based on current legal requirements, things that might become legal requirements in the future, and best practices. One combined measurement makes it harder discern the difference between those three things.
        </p>
      </aside>

      <h3>
        APCA contrast
      </h3>

      <div>
        <p>
          These are contrast measurements we have to meet or exceed to ensure great legibility. These requirements will also reduce the chances that we need to update our palette if/when WCAG and legal standards start using a better color contrast measurement.
        </p>

        <p>
          <strong>This is not a complete list of current APCA requirements.</strong> This is a simplified list of key benchmarks a color palette has to be able to meet. A palette robust enough to meet these strict thresholds should have the flexibility we need to make great designs.
        </p>

        <h4>
          APCA text minimum contrast
        </h4>

        <table>
          <tr>
            <th></th>
            <th>
              Regular
              <br>
              (less than 700)
            </th>
            <th>
              Bold
              <br>
              (at least 700)
            </th>
          </tr>

          <tr>
            <th>14px or smaller</th>
            <td>Lc 95</td>
            <td>Lc 75</td>
          </tr>

          <tr>
            <th>16px</th>
            <td>Lc 85</td>
            <td>Lc 75</td>
          </tr>

          <tr>
            <th>18px</th>
            <td>Lc 75</td>
            <td>Lc 65</td>
          </tr>

          <tr>
            <th>24px or larger</th>
            <td>Lc 75</td>
            <td>Lc 60</td>
          </tr>

          <tr>
            <th>
              Unimportant text
              <br>
              (Disabled, copyright statements, etc)
            </th>
            <td colspan="2">Lc 30</td>
          </tr>
        </table>

        <h4>
          APCA non-text minimum contrast
        </h4>

        <table>
          <tr>
            <th></th>
            <th>
              Outlined
            </th>
            <th>
              Solid
            </th>
          </tr>

          <tr>
            <th>Icons</th>
            <td>Lc 75</td>
            <td>Lc 60</td>
          </tr>

          <tr>
            <th>Buttons</th>
            <td colspan="2">
              Lc 60
              <span class="note">
                Contrast of border or fill against the background, not the text inside the button.
              </span>
            </td>
          </tr>

          <tr>
            <th>Inputs</th>
            <td colspan="2">
              Lc 60
              <span class="note">
                Contrast of outline or other non-text visuals that make it look like an input, not the text inside the input.
              </span>
            </td>
          </tr>

          <tr>
            <th>Data Visualizations</th>
            <td>
              Lc 75
              <span class="note">
                Line graphs, icons in charts, etc.
              </span>
            </td>
            <td>
              Lc 60
              <span class="note">
                Filled in area plots, pie chart slices, etc.
              </span>
            </td>
          </tr>

          <tr>
            <th>
              Sectioning
            </th>
            <td>
              Lc 30
              <span class="note">
                Dividing lines between sections.
              </span>
            </td>
            <td>
              Lc 15
              <span class="note">
                Contrast between background colors used to indicate sections.
              </span>
            </td>
          </tr>
        </table>
      </div>

      <aside>
        <h4>
          What is Lc?
        </h4>

        <p>
          "Lightness contrast" or Lc is the unit used by APCA to measure the perceived contrast levels. Light text against a dark background gets negative value, but you can ignore the negative sign when checking if a color passes in this table.
        </p>

        <h4>
          Why these values?
        </h4>

        <p>
          We discussed what the most common text sizes are in current designs as well as future plans for text accessibility requirements. Based on that, we came up with this reduced set of goals. These requirements may be stricter than what will be required of future designs.
        </p>
        <p>
          However, if a color palette can support all of these use cases, we can be confident that it can be used to create very legible designs that meet the highest standards. Better to have a color palette capable of exceeding future requirements than one that only barely meets today's requirements.
        </p>
      </aside>

      <h2>
        Link text
      </h2>

      <div>
        <ol>
          <li>
            Link text must have an obviously distinct hue and/or saturation when compared to plain text for people with full color vision as well as those with deuteranopia, protanopia, and tritanopia. <br> <a href="#distinct-colors">See note on measuring color differences.</a>
          </li>
        </ol>
      </div>

      <aside>
        <h3 id="link-contrast">
          Link contrast complications
        </h3>

        <p>
          While links don't have a maximum contrast ratio, a balance must be struck between having great contrast against the background for readability and having a visible difference from normal body text for people with and without color vision deficiencies. These two requirements are often in conflict, and some hues are especially difficult to get to pass both requirements in light or dark themes.
        </p>
      </aside>

      <h2>
        Buttons
      </h2>

      <div id="buttons">
        <ol>
          <li>
            <p>
              Whatever visually element indicates "this is a button" needs to pass the relevant WCAG 2 and APCA contrast requirements.
            </p>
            <p>
              Some buttons look like buttons because of the border around them. Other buttons are defined visually by their fill color. These two have different contrast requirements because a thin border is harder to see than a solid colored block.
            </p>
          </li>
          <li>
            The text of a button always needs to meet the relevant contrast requirement when compared the background inside the button. If the button contains a gradient, the text needs to pass contrast rules against all colors in the gradient.
          </li>
          <li>
            There must be support for at least 4 semantically distinct button colors: primary and secondary (often grey and blue), as well as approve and deny (often green and red).
          </li>
          <li>
            All semantically distinct button colors must have an obviously distinct value, hue and/or saturation for people with full color vision as well as those with deuteranopia, protanopia, and tritanopia. <br> <a href="#distinct-colors">See note on measuring color differences.</a>
          </li>
        </ol>
      </div>

      <h2>
        Status indicators
      </h2>

      <div>
        <ol>
          <li>
            There are at least 4 color families that can be used for status indicators: positive (often green), mild negative (often orange), major negative (often red), and neutral (often blue or gray). These do not have to be specific hues.
          </li>
          <li>
            All status indication colors must have an obviously distinct value, hue and/or saturation for people with full color vision as well as those with deuteranopia, protanopia, and tritanopia. <br> <a href="#distinct-colors">See note on measuring color differences.</a>
          </li>
        </ol>
      </div>

      <aside>
        <h3 id="why-consider-cvd">
          Are these color vision deficiency requirements needed?
        </h3>

        <p>
          To meet WCAG 2 requirements, color can never be the only indication of something users need to differentiate. There must be text, shape, iconography, texture, or some other non-color indicator. This is great to make things clear for everyone, especially people with severe color vision disabilities.
        </p>

        <p>
          However, visible color differences are important for good usability. Noticing anomalies in a table of users or devices is much easier if there is a clear color difference between the status indicators on each row. If we don't design for color vision deficiencies it is easy to make a design where all the status colors look different except for the most positive and negative status colors. That is arguable worse than if all the colors looked the same.
        </p>

        <p>
          These color requirements can be met by differentiating hues and/or perceived value. For example, red and green hues can be hard for some people to distinguish, but it can be sufficient to make the red visibly darker than the green or visa versa. Differences in value also help to highlight actionable statuses.
        </p>
      </aside>

      <h2>
        Data Visualizations
      </h2>

      <div>
        <ol>
          <li>
            There are at least 5 colors that can be used in data visualizations to separate different categories. Support for more colors is good.
          </li>
          <li>
            All categorical colors must have an obviously distinct value, hue and/or saturation for people with full color vision as well as those with deuteranopia, protanopia, and tritanopia. <br> <a href="#distinct-colors">See note on measuring color differences.</a>
          </li>
          <li>
            None of category colors could be confused with the colors of the most common interactive elements (links, primary and secondary buttons, etc) by people with full color vision as well as those with deuteranopia, protanopia, and tritanopia.
          </li>
        </ol>
      </div>

      <aside>
        <h4>
          What does "semantically distinct" mean?
        </h4>

        <p>
          "Semantically distinct" colors are colors where the hue or the fact that they look different from other buttons communicates something about what they do. Any time color is used to communicated semantics, we want the semantics to be the same for everyone, regardless of their color vision.
        </p>

        <p>
          We often make "Save", "Accept", "Next" and similar primary buttons a distinct color to make it easier for people to quickly identify buttons with a similar purpose: "this is the primary action".
        </p>

        <p>
          If there are buttons on separate parts of a page or on different pages that have distinct colors, it could be okay if they look the same to some people as long as being unable to distinguish the colors doesn't change the usability of the application. Them being different colors has no semantic meaning, it is just aesthetics.
        </p>

        <p>
          However, imagine we have a line of buttons next to one another, each with a unique color. Each color might not have a specific semantic meaning, but we do need them to look different for all people. Users would assume different things about the relationship between buttons in a line if they were all different colors versus if only some appeared to have the same color.
        </p>
      </aside>

      <h2>
        Recommended tools
      </h2>

      <h3>
        WCAG 2 contrast tools
      </h3>

      <p>
        Every plugin and tool we've tested measures WCAG 2 contrast correctly. WCAG 2 contrast is well established and the math is relatively simple. Use whatever ones you prefer.
      </p>

      <h3>
        APCA contrast tools
      </h3>

      <p>
        Because APCA is under active development, some tools use outdated versions of the measurement, and any 3rd party tools we recommend now could become dated later. For critical tasks, <a href="https://www.myndex.com/apca/">the tool the creator of APCA hosts</a> should be considered the source of truth until the measurement is standardized. Any Figma plugin that matches the values found using that tool is okay.
      </p>

      <p>
        Note: APCA differentiates between the background and foreground (usually text) colors. Make sure your colors are in the correct fields as swapping them will alter the measured contrast.
      </p>

      <h3>
        Color vision simulators
      </h3>

      <div>
        <p>
          <a href="https://daltonlens.org/#software">DaltonLens for MacOS and Windows</a> is simulator that passes our accuracy requirements. To use it: grab a screen region, use the "DaltonLens Controls" window to select "Daltonize", check "Only simulate color vision deficiency", select the form of color blindess you wish to simulate, and make sure the severity is set to all the way up to 1.00.
        </p>

        <p>
          <a href="https://developer.chrome.com/blog/new-in-devtools-83/#vision-deficiencies">Chrome has simulators built into their dev tools</a> that will simulate the three most common forms of color vision deficiencies for whatever page you are looking at. The model they use is good enough for spot checking designs.
        </p>

        <p>
          We are actively trying to find a good Figma plugin. So far every one tested uses inaccurate models.
        </p>
      </div>

      <aside>
        <h4>
          Which forms of color vision deficiencies should we test?
        </h4>

        <p>
          We only recommend testing for dichromacy (protanopia, deuteranopia and tritanopia), which is when someone can't see one of the primary colors. Those three cover the needs of the vast majority of people with color vision deficiencies.
        </p>

        <p>
          You do not need to test for anomalous trichromacy (protanomaly, deuteranomaly and tritanomaly) as these are just less severe versions of dichromacy. Monochromacy isn't worth simulating for general design work. It comes a few different forms, is often accompanied by other severe visual disabilities, is misrepresented by most simulators (you can't just convert a design to greyscale), and there is little research into valid simulation techniques due to the rarity. Monochromacy can be accommodated with other design choices.
        </p>

        <h4>
          How do we validate color vision simulators?
        </h4>

        <p>
          We only recommend using simulators that use models based on peer reviewed research and validation with real people. <a href="https://daltonlens.org/opensource-cvd-simulation/">Currently the Brettel (1997) and Vienot (1999) models appear to be the best models available</a>. For tritanopia Brettel is preferred. For deuteranopia and protanopia Vienot is preferred. Simulators using the Machado (2009) model should be okay for spot checking designs, but some informal testing suggests it isn't quite as accurate as Brettel or Vienot. To validate a simulator, we compare a rainbow grid against the <a href="https://daltonlens.org/colorblindness-simulator">known good models</a>.
        </p>
      </aside>
    </main>
  </body>
</html>